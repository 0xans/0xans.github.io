<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Reader | 0xAns</title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
        <script src="[https://unpkg.com/@phosphor-icons/web](https://unpkg.com/@phosphor-icons/web)"></script>
        <script src="[https://cdn.jsdelivr.net/npm/marked/marked.min.js](https://cdn.jsdelivr.net/npm/marked/marked.min.js)"></script>
        <link rel="stylesheet" href="[https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/tokyo-night-dark.min.css](https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/tokyo-night-dark.min.css)">
        <script src="[https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js](https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js)"></script>
        <script src="[https://cdn.tailwindcss.com](https://cdn.tailwindcss.com)"></script>
        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        fontFamily: { sans: ['Inter', 'sans-serif'], mono: ['JetBrains Mono', 'monospace'] },
                        colors: {
                            rosepine: { base: '#191724', surface: '#1f1d2e', overlay: '#26233a', muted: '#6e6a86', text: '#e0def4', love: '#eb6f92', gold: '#f6c177', rose: '#ebbcba', pine: '#31748f', foam: '#9ccfd8', iris: '#c4a7e7', highlight: { low: '#21202e', med: '#403d52', high: '#524f67' } }
                        },
                        typography: {
                            DEFAULT: { css: { color: '#e0def4', maxWidth: 'none' } }
                        }
                    }
                }
            }
        </script>
        <style>
            body { background-color: #191724; overflow: hidden; }
            ::-webkit-scrollbar { width: 6px; height: 6px; }
            ::-webkit-scrollbar-track { background: transparent; }
            ::-webkit-scrollbar-thumb { background: #26233a; border-radius: 3px; }
            ::-webkit-scrollbar-thumb:hover { background: #403d52; }
            .article-content { font-size: 1.05rem; color: #e0def4; line-height: 1.75; }
            .article-content h1, .article-content h2, .article-content h3, .article-content h4 { scroll-margin-top: 100px; font-weight: 700; color: #e0def4; margin-top: 2em; margin-bottom: 0.5em; letter-spacing: -0.025em; }
            .article-content h1 { font-size: 2rem; border-bottom: 1px solid #26233a; padding-bottom: 0.5rem; color: #ebbcba; }
            .article-content h2 { font-size: 1.5rem; color: #eb6f92; }
            .article-content h3 { font-size: 1.25rem; color: #9ccfd8; }
            .article-content h4 { font-size: 1.1rem; color: #c4a7e7; }
            .article-content p { margin-bottom: 1.5em; color: #e0def4; }
            .article-content a { color: #ebbcba; text-decoration: none; border-bottom: 1px solid #ebbcba; transition: all 0.2s; }
            .article-content a:hover { background: rgba(235, 188, 186, 0.1); border-bottom-color: transparent; }
            .article-content blockquote { border-left: 3px solid #eb6f92; padding-left: 1rem; margin: 1.5rem 0; color: #908caa; font-style: italic; }
            .article-content strong { color: #f6c177; font-weight: 600; }
            .article-content ul, .article-content ol { padding-left: 1.5rem; margin-bottom: 1.5rem; color: #e0def4; }
            .article-content ul { list-style: disc; }
            .article-content ol { list-style: decimal; }
            .article-content li { margin-bottom: 0.5em; }
            .article-content li::marker { color: #6e6a86; }
            .article-content pre { background: #1f1d2e !important; padding: 1rem; border-radius: 6px; border: 1px solid #26233a; margin: 1.5rem 0; overflow-x: auto; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
            .article-content code { font-family: 'JetBrains Mono'; font-size: 0.85em; background: rgba(235, 111, 146, 0.1); padding: 0.2em 0.4em; border-radius: 4px; color: #eb6f92; }
            .article-content pre code { background: transparent; padding: 0; color: inherit; font-size: 0.9em; }
            .article-content img { max-width: 100%; height: auto; display: block; margin: 2rem auto; border-radius: 8px; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3); }
            .article-content hr { border-color: #26233a; margin: 3rem 0; }
            .article-content table { width: 100%; border-collapse: collapse; margin: 2rem 0; font-size: 0.9rem; }
            .article-content th { text-align: left; padding: 0.75rem; border-bottom: 1px solid #403d52; color: #9ccfd8; font-weight: 600; }
            .article-content td { padding: 0.75rem; border-bottom: 1px solid #26233a; color: #908caa; }
            .search-match { background-color: rgba(235, 111, 146, 0.2); color: #eb6f92; font-weight: bold; border-radius: 2px; padding: 0 2px; }
            .resizer { width: 4px; cursor: col-resize; background: transparent; transition: background 0.2s; z-index: 50; flex-shrink: 0; }
            .resizer:hover, .resizer.active { background: #eb6f92; }
            .toc-link.active { color: #eb6f92; border-left-color: #eb6f92; font-weight: 600; }
            .toc-link { border-left: 2px solid transparent; padding-left: 1rem; display: block; transition: all 0.2s; }
            .toc-link:hover { color: #e0def4; border-left-color: #403d52; }
        </style>
    </head>
    <body class="antialiased text-rosepine-text flex h-screen w-screen">
        <div id="sidebar-overlay" class="fixed inset-0 bg-black/60 z-30 hidden lg:hidden backdrop-blur-sm transition-opacity"></div>
        <aside id="sidebar" class="bg-rosepine-surface border-r border-rosepine-highlight-low flex flex-col h-full absolute lg:relative z-40 transition-transform duration-300 -translate-x-full lg:translate-x-0 w-[280px] shrink-0">
            <div class="h-14 flex items-center justify-between px-4 border-b border-rosepine-highlight-low shrink-0">
                <div class="flex items-center gap-2">
                    <div class="w-2 h-2 rounded-full bg-rosepine-love"></div>
                    <span class="font-mono font-bold text-rosepine-text">0xAns</span>
                </div>
                <button id="collapse-btn" class="hidden lg:flex p-1 hover:bg-rosepine-overlay rounded text-rosepine-muted hover:text-rosepine-text transition-colors" title="Close Sidebar">
                <i class="ph ph-arrows-in-line-horizontal"></i>
                </button>
                <button id="mobile-close-btn" class="lg:hidden p-1 text-rosepine-love">
                <i class="ph ph-x text-lg"></i>
                </button>
            </div>
            <div class="p-3 shrink-0">
                <div class="relative group">
                    <i class="ph ph-magnifying-glass absolute left-2.5 top-1/2 -translate-y-1/2 text-rosepine-muted group-focus-within:text-rosepine-love transition-colors text-sm"></i>
                    <input type="text" id="sidebar-search" placeholder="Search..." 
                        class="w-full bg-rosepine-base/50 border border-rosepine-highlight-med rounded-md py-1.5 pl-8 pr-3 text-sm text-rosepine-text focus:outline-none focus:border-rosepine-love focus:bg-rosepine-base transition-all placeholder-rosepine-highlight-high">
                </div>
            </div>
            <div class="flex-grow overflow-y-auto px-3 pb-4 space-y-6" id="sidebar-list">
            </div>
            <div class="p-4 border-t border-rosepine-highlight-low shrink-0">
                <a id="nav-github" href="#" target="_blank" class="flex items-center gap-2 text-xs font-mono text-rosepine-muted hover:text-rosepine-love transition-colors">
                <i class="ph ph-github-logo text-lg"></i>
                <span>[github.com/0xAns](https://github.com/0xAns)</span>
                </a>
            </div>
        </aside>
        <div id="resizer" class="resizer hidden lg:block"></div>
        <main class="flex-1 flex flex-col h-full min-w-0 bg-rosepine-base relative">
            <header class="h-14 border-b border-rosepine-highlight-low flex items-center px-6 justify-between bg-rosepine-base/95 backdrop-blur z-20 sticky top-0">
                <div class="flex items-center gap-3 overflow-hidden">
                    <button id="mobile-menu-btn" class="lg:hidden text-rosepine-text hover:text-rosepine-love">
                    <i class="ph ph-list text-xl"></i>
                    </button>
                    <button id="expand-btn" class="hidden text-rosepine-muted hover:text-rosepine-love transition-colors" title="Open Sidebar">
                    <i class="ph ph-sidebar text-xl"></i>
                    </button>
                    <div class="hidden sm:flex items-center gap-2 text-sm font-mono text-rosepine-muted whitespace-nowrap overflow-hidden text-ellipsis" id="breadcrumbs">
                        <span>/</span>
                        <span class="text-rosepine-text truncate" id="crumb-title">Select an article</span>
                    </div>
                </div>
                <div class="flex items-center gap-3 text-sm font-mono shrink-0">
                    <button id="width-toggle" onclick="toggleWidth()" class="flex items-center gap-2 text-rosepine-muted hover:text-rosepine-text transition-colors px-2 py-1 hover:bg-rosepine-overlay rounded" title="Toggle Full Width">
                    <i id="width-icon" class="ph ph-arrows-out-line-horizontal text-lg"></i>
                    <span class="hidden md:inline text-xs">Full Width</span>
                    </button>
                    <div class="w-px h-4 bg-rosepine-highlight-med mx-1"></div>
                    <a href="index.html" class="text-rosepine-rose hover:text-rosepine-love">./home</a>
                </div>
            </header>
            <div id="main-scroll" class="flex-1 overflow-y-auto scroll-smooth">
                <div class="flex justify-center min-h-full">
                    <div id="article-wrapper" class="flex-1 w-full max-w-3xl px-6 py-12 transition-all duration-300 mx-auto">
                        <div id="loading" class="flex flex-col items-center justify-center py-20 text-rosepine-muted animate-pulse">
                            <i class="ph ph-spinner-gap text-3xl mb-4 animate-spin"></i>
                            <span class="font-mono text-sm">Initialising Reader...</span>
                        </div>
                        <article id="content-area" class="hidden fade-in">
                            <div id="header-image-container" class="mb-8 hidden">
                                <img id="header-image" src="" alt="Header" class="w-full h-48 md:h-64 object-cover rounded-xl border border-rosepine-highlight-low shadow-lg shadow-rosepine-base/50">
                            </div>
                            <header class="mb-10 pb-6 border-b border-rosepine-highlight-low">
                                <div class="flex flex-wrap gap-2 mb-4" id="tags-container"></div>
                                <h1 id="art-title" class="text-3xl md:text-5xl font-bold text-rosepine-text mb-6 tracking-tight"></h1>
                                <div class="flex flex-wrap items-center gap-6 text-sm font-mono text-rosepine-muted">
                                    <div class="flex items-center gap-2">
                                        <i class="ph ph-calendar-blank text-rosepine-love"></i>
                                        <span id="art-date"></span>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <i class="ph ph-folder-open text-rosepine-foam"></i>
                                        <span id="art-category"></span>
                                    </div>
                                </div>
                            </header>
                            <div id="markdown-body" class="article-content font-sans"></div>
                        </article>
                        <footer class="mt-20 pt-10 border-t border-rosepine-highlight-low text-center pb-10">
                            <p class="font-mono text-sm text-rosepine-muted">0xAns Reader Engine v2.1</p>
                        </footer>
                    </div>
                    <aside id="toc-sidebar" class="hidden xl:block w-64 shrink-0 border-l border-rosepine-highlight-low bg-rosepine-base/50 p-6 sticky top-0 h-screen overflow-y-auto">
                        <h4 class="text-xs font-bold font-mono text-rosepine-muted uppercase tracking-wider mb-4">On this page</h4>
                        <nav id="toc-content" class="text-sm space-y-1 text-rosepine-muted">
                        </nav>
                    </aside>
                </div>
            </div>
        </main>
        <script>
            const urlParams = new URLSearchParams(window.location.search);
            const currentArticleId = urlParams.get('id');
            let allArticles = [];
            let isFullWidth = localStorage.getItem('isFullWidth') === 'true';
            
            const sidebar = document.getElementById('sidebar');
            const resizer = document.getElementById('resizer');
            const collapseBtn = document.getElementById('collapse-btn');
            const expandBtn = document.getElementById('expand-btn');
            const articleWrapper = document.getElementById('article-wrapper');
            const tocSidebar = document.getElementById('toc-sidebar');
            const widthIcon = document.getElementById('width-icon');
            
            let sidebarWidth = parseInt(localStorage.getItem('sidebarWidth')) || 280;
            let isSidebarOpen = localStorage.getItem('isSidebarOpen') !== 'false';
            
            function toggleWidth() {
                isFullWidth = !isFullWidth;
                localStorage.setItem('isFullWidth', isFullWidth);
                applyWidth();
            }
            
            function applyWidth() {
                if (isFullWidth) {
                    articleWrapper.classList.remove('max-w-3xl', 'mx-auto');
                    articleWrapper.classList.add('max-w-full', 'px-10', 'lg:px-20');
                    widthIcon.classList.replace('ph-arrows-out-line-horizontal', 'ph-arrows-in-line-horizontal');
                } else {
                    articleWrapper.classList.add('max-w-3xl', 'mx-auto');
                    articleWrapper.classList.remove('max-w-full', 'px-10', 'lg:px-20');
                    widthIcon.classList.replace('ph-arrows-in-line-horizontal', 'ph-arrows-out-line-horizontal');
                }
            }
            
            applyWidth();
            
            function setSidebarState(isOpen, width) {
                if (!isOpen) {
                    sidebar.style.display = 'none';
                    resizer.style.display = 'none';
                    expandBtn.classList.remove('hidden');
                } else {
                    sidebar.style.display = 'flex';
                    resizer.style.display = 'block';
                    sidebar.style.width = `${width}px`;
                    expandBtn.classList.add('hidden');
                }
                localStorage.setItem('isSidebarOpen', isOpen);
                localStorage.setItem('sidebarWidth', width);
            }
            
            if (window.innerWidth >= 1024) {
                setSidebarState(isSidebarOpen, sidebarWidth);
            }
            
            let isResizing = false;
            
            resizer.addEventListener('mousedown', (e) => {
                isResizing = true;
                document.body.style.cursor = 'col-resize';
                resizer.classList.add('active');
            });
            
            document.addEventListener('mousemove', (e) => {
                if (!isResizing) return;
                let newWidth = e.clientX;
                if (newWidth < 200) newWidth = 200;
                if (newWidth > 500) newWidth = 500;
                
                sidebarWidth = newWidth;
                sidebar.style.width = `${newWidth}px`;
            });
            
            document.addEventListener('mouseup', () => {
                if (isResizing) {
                    isResizing = false;
                    document.body.style.cursor = 'default';
                    resizer.classList.remove('active');
                    localStorage.setItem('sidebarWidth', sidebarWidth);
                }
            });
            
            collapseBtn.addEventListener('click', () => setSidebarState(false, sidebarWidth));
            expandBtn.addEventListener('click', () => setSidebarState(true, sidebarWidth));
            
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileCloseBtn = document.getElementById('mobile-close-btn');
            const overlay = document.getElementById('sidebar-overlay');
            
            function toggleMobileMenu() {
                const isClosed = sidebar.classList.contains('-translate-x-full');
                if (isClosed) {
                    sidebar.classList.remove('-translate-x-full');
                    overlay.classList.remove('hidden');
                } else {
                    sidebar.classList.add('-translate-x-full');
                    overlay.classList.add('hidden');
                }
            }
            
            mobileMenuBtn.addEventListener('click', toggleMobileMenu);
            mobileCloseBtn.addEventListener('click', toggleMobileMenu);
            overlay.addEventListener('click', toggleMobileMenu);
            
            function highlightMatch(text, term) {
                if (!term) return text;
                const escapedTerm = term.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                const regex = new RegExp(`(${escapedTerm})`, 'gi');
                return text.replace(regex, '<span class="search-match">$1</span>');
            }
            
            function renderSidebar(articles, searchTerm = "") {
                const container = document.getElementById('sidebar-list');
                container.innerHTML = '';
                
                const categories = {};
                articles.forEach(art => {
                    const cat = art.category || 'General';
                    if(!categories[cat]) categories[cat] = [];
                    categories[cat].push(art);
                });
            
                const hasResults = Object.keys(categories).length > 0;
            
                if (!hasResults) {
                    container.innerHTML = `<div class="text-xs text-rosepine-muted text-center italic mt-4">No matching articles found.</div>`;
                    return;
                }
            
                for (const [cat, items] of Object.entries(categories)) {
                    const catHeader = document.createElement('h3');
                    catHeader.className = 'text-[11px] font-bold font-mono text-rosepine-muted uppercase tracking-wider mb-2 mt-2 px-2';
                    catHeader.textContent = cat;
                    container.appendChild(catHeader);
            
                    const ul = document.createElement('ul');
                    ul.className = 'space-y-0.5 mb-4';
                    
                    items.forEach(art => {
                        const li = document.createElement('li');
                        const isActive = art.id === currentArticleId;
                        
                        const displayTitle = highlightMatch(art.title, searchTerm);
                        
                        li.innerHTML = `
                            <a href="?id=${art.id}" class="block text-[13px] py-1.5 px-2.5 rounded transition-all truncate border border-transparent ${isActive 
                                ? 'bg-rosepine-highlight-low border-rosepine-highlight-med text-rosepine-rose font-medium shadow-sm' 
                                : 'text-rosepine-subtle hover:text-rosepine-text hover:bg-rosepine-surface hover:border-rosepine-highlight-low'}">
                                ${displayTitle}
                            </a>
                        `;
                        ul.appendChild(li);
                    });
                    container.appendChild(ul);
                }
            }
            
            function generateToC() {
                const tocContainer = document.getElementById('toc-content');
                tocContainer.innerHTML = '';
                
                const headings = document.querySelectorAll('#markdown-body h1, #markdown-body h2, #markdown-body h3');
                
                if (headings.length === 0) {
                    tocSidebar.classList.add('hidden');
                    return;
                } else {
                    tocSidebar.classList.remove('hidden');
                }
            
                headings.forEach((heading, index) => {
                    if (!heading.id) {
                        heading.id = `heading-${index}`;
                    }
            
                    const link = document.createElement('a');
                    link.href = `#${heading.id}`;
                    link.className = 'toc-link block py-1 text-rosepine-muted hover:text-rosepine-text transition-colors truncate';
                    link.textContent = heading.textContent;
                    
                    if (heading.tagName === 'H3') {
                        link.style.paddingLeft = '1.5rem';
                        link.style.fontSize = '0.9em';
                    }
                    
                    link.onclick = (e) => {
                        e.preventDefault();
                        document.getElementById(heading.id).scrollIntoView({ behavior: 'smooth' });
                    };
            
                    tocContainer.appendChild(link);
                });
            
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            document.querySelectorAll('.toc-link').forEach(l => l.classList.remove('active'));
                            const activeLink = document.querySelector(`.toc-link[href="#${entry.target.id}"]`);
                            if (activeLink) activeLink.classList.add('active');
                        }
                    });
                }, { rootMargin: '-100px 0px -66%' });
            
                headings.forEach(h => observer.observe(h));
            }
            
            document.getElementById('sidebar-search').addEventListener('input', (e) => {
                const term = e.target.value.toLowerCase();
                const filtered = allArticles.filter(a => a.title.toLowerCase().includes(term));
                renderSidebar(filtered, e.target.value);
            });
            
            marked.use({ 
                gfm: true,
                breaks: true 
            });
            
            fetch('data/content.json')
                .then(r => r.json())
                .then(data => {
                    if(data.profile) document.getElementById('nav-github').href = data.profile.github;
                    
                    if(data.articles) {
                        allArticles = data.articles;
                        renderSidebar(allArticles);
            
                        if (currentArticleId) {
                            const article = data.articles.find(a => a.id === currentArticleId);
                            if (article) {
                                document.title = article.title + " | 0xAns";
                                document.getElementById('art-title').textContent = article.title;
                                document.getElementById('crumb-title').textContent = article.title;
                                document.getElementById('art-date').textContent = article.date;
                                document.getElementById('art-category').textContent = article.category || 'Article';
                                
                                if (article.image) {
                                    const imgContainer = document.getElementById('header-image-container');
                                    const img = document.getElementById('header-image');
                                    img.src = article.image;
                                    imgContainer.classList.remove('hidden');
                                }
            
                                const tagContainer = document.getElementById('tags-container');
                                article.tags.forEach(tag => {
                                    tagContainer.innerHTML += `
                                        <span class="px-2 py-0.5 text-[10px] font-mono bg-rosepine-highlight-low border border-rosepine-highlight-med text-rosepine-iris rounded-md opacity-80 hover:opacity-100 transition-opacity">#${tag}</span>
                                    `;
                                });
            
                                fetch(article.file)
                                    .then(r => r.text())
                                    .then(md => {
                                        const contentDiv = document.getElementById('markdown-body');
                                        contentDiv.innerHTML = marked.parse(md);
                                        
                                        document.querySelectorAll('pre code').forEach((el) => hljs.highlightElement(el));
                                        
                                        document.getElementById('loading').classList.add('hidden');
                                        document.getElementById('content-area').classList.remove('hidden');
                                        
                                        generateToC();
                                    })
                                    .catch(err => {
                                         document.getElementById('loading').innerHTML = `<p class="text-rosepine-love">Failed to load markdown file.</p>`;
                                    });
                            }
                        } else {
                             document.getElementById('loading').innerHTML = `
                                <div class="text-center">
                                    <i class="ph ph-book-open text-4xl text-rosepine-iris mb-4"></i>
                                    <p class="text-rosepine-text">Select an article from the sidebar to begin reading.</p>
                                </div>`;
                                
                             tocSidebar.classList.add('hidden');
                             document.getElementById('width-toggle').classList.add('hidden');
                        }
                    }
                })
                .catch(err => {
                    console.error(err);
                    document.getElementById('loading').innerHTML = `<p class="text-rosepine-love">Error loading content data.</p>`;
                });
        </script>
    </body>
</html>
